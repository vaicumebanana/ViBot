<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ViBot Ultra</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4f46e5;
            --user-bg: #4f46e5;
            --bot-bg: #f3f4f6;
            --error-bg: #fee2e2;
            --text: #111827;
            --error-text: #dc2626;
            --bg: #f9fafb;
            --copy-bg: #e5e7eb;
            --toolbar-bg: #e5e7eb;
            --sidebar-width: 280px;
            --mobile-header-height: 60px;
            --mobile-footer-height: 70px;
            --danger: #ef4444;
            
            /* Cores das categorias */
            --produtividade: #3b82f6;
            --criatividade: #8b5cf6;
            --vida-diaria: #10b981;
            --educacao: #f59e0b;
            --negocios: #ec4899;
            --tecnologia: #6366f1;
            --entretenimento: #ef4444;
            --especializadas: #14b8a6;
            --social: #f97316;
            --diversos: #64748b;
        }
        [data-theme="dark"] {
            --primary: #6366f1;
            --bg: #1f2937;
            --bot-bg: #374151;
            --text: #f9fafb;
            --user-bg: #6366f1;
            --copy-bg: #4b5563;
            --toolbar-bg: #374151;
            --danger: #dc2626;
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: background 0.3s, color 0.3s;
            line-height: 1.6;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            touch-action: manipulation;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            height: var(--mobile-header-height);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
        }
        [data-theme="dark"] header {
            background: #111827;
            border-color: #374151;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .logo-icon {
            width: 36px;
            height: 36px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        h1 {
            margin: 0;
            color: var(--primary);
            font-size: 1.4rem;
            font-weight: 700;
        }
        .header-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f3f4f6;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: var(--text);
        }
        [data-theme="dark"] .header-btn {
            background: #2d3748;
            color: white;
        }
        main {
            display: flex;
            flex: 1;
            overflow: hidden;
            padding-top: var(--mobile-header-height);
            padding-bottom: var(--mobile-footer-height);
        }
        #sidebar {
            position: fixed;
            top: var(--mobile-header-height);
            left: 0;
            bottom: var(--mobile-footer-height);
            width: 100%;
            background: white;
            z-index: 90;
            display: flex;
            flex-direction: column;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
        }
        #sidebar.active {
            transform: translateX(0);
        }
        [data-theme="dark"] #sidebar {
            background: #111827;
        }
        #tools-sidebar {
            position: fixed;
            top: var(--mobile-header-height);
            right: 0;
            bottom: var(--mobile-footer-height);
            width: 100%;
            background: white;
            z-index: 90;
            display: flex;
            flex-direction: column;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
            padding: 16px;
        }
        #tools-sidebar.active {
            transform: translateX(0);
        }
        [data-theme="dark"] #tools-sidebar {
            background: #111827;
        }
        #chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            width: 100%;
        }
        #chatbox {
            background: white;
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
        }
        [data-theme="dark"] #chatbox {
            background: #1a202c;
        }
        .message {
            padding: 14px 18px;
            border-radius: 18px;
            max-width: 90%;
            line-height: 1.5;
            animation: fadeIn 0.3s ease-out;
            word-wrap: break-word;
            position: relative;
            font-size: 16px;
        }
        .user {
            background: var(--user-bg);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        .bot {
            background: var(--bot-bg);
            color: var(--text);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        .error {
            background: var(--error-bg);
            color: var(--error-text);
            align-self: center;
            text-align: center;
            max-width: 95%;
            padding: 12px;
        }
        .typing {
            color: #6b7280;
            font-style: italic;
            animation: blink 1s steps(1) infinite;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes blink {
            50% {
                opacity: 0.5;
            }
        }
        #input-area {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            background: white;
            border-top: 1px solid #e5e7eb;
            height: var(--mobile-footer-height);
            display: flex;
            align-items: center;
            z-index: 80;
        }
        [data-theme="dark"] #input-area {
            background: #111827;
            border-color: #374151;
        }
        #input-container {
            display: flex;
            gap: 10px;
            width: 100%;
            max-width: 100%;
        }
        #userInput {
            flex: 1;
            padding: 14px 18px;
            border: 1px solid #e5e7eb;
            border-radius: 25px;
            font-size: 16px;
            background: white;
            min-height: 50px;
            resize: none;
            line-height: 1.4;
            color: var(--text);
        }
        [data-theme="dark"] #userInput {
            background: #1f2937;
            color: white;
            border-color: #4b5563;
        }
        #sendBtn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            flex-shrink: 0;
        }
        #sendBtn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        #newConversationBtn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px;
            font-weight: 600;
            margin: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        #conversationList {
            overflow-y: auto;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 0 20px 20px;
        }
        .conversation-btn {
            background: #f3f4f6;
            border: none;
            border-radius: 12px;
            padding: 14px 18px;
            font-size: 16px;
            color: var(--text);
            text-align: left;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        [data-theme="dark"] .conversation-btn {
            background: #2d3748;
        }
        .conversation-btn.active {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }
        .conversation-icon {
            font-size: 18px;
        }
        .conversation-delete {
            margin-left: auto;
            background: none;
            border: none;
            color: var(--danger);
            font-size: 14px;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .conversation-delete:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        .settings-panel {
            padding: 20px;
            background: var(--bot-bg);
            border-radius: 16px;
            margin: 20px;
        }
        .tools-panel {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 10px;
        }
        
        /* Novo estilo para categorias */
        .category-container {
            margin-bottom: 15px;
        }
        
        .category-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .category-btn i {
            transition: transform 0.3s;
        }
        
        .category-btn.expanded i {
            transform: rotate(90deg);
        }
        
        .category-tools {
            display: none;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        .category-tools.active {
            display: grid;
        }
        
        .tools-panel-btn {
            background: var(--tool-color);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            height: 100px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .tools-panel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .tools-panel-icon {
            font-size: 24px;
        }
        
        /* Cores específicas para cada categoria */
        .produtividade-btn { background-color: var(--produtividade); }
        .produtividade-tool { --tool-color: var(--produtividade); }
        
        .criatividade-btn { background-color: var(--criatividade); }
        .criatividade-tool { --tool-color: var(--criatividade); }
        
        .vida-diaria-btn { background-color: var(--vida-diaria); }
        .vida-diaria-tool { --tool-color: var(--vida-diaria); }
        
        .educacao-btn { background-color: var(--educacao); }
        .educacao-tool { --tool-color: var(--educacao); }
        
        .negocios-btn { background-color: var(--negocios); }
        .negocios-tool { --tool-color: var(--negocios); }
        
        .tecnologia-btn { background-color: var(--tecnologia); }
        .tecnologia-tool { --tool-color: var(--tecnologia); }
        
        .entretenimento-btn { background-color: var(--entretenimento); }
        .entretenimento-tool { --tool-color: var(--entretenimento); }
        
        .especializadas-btn { background-color: var(--especializadas); }
        .especializadas-tool { --tool-color: var(--especializadas); }
        
        .social-btn { background-color: var(--social); }
        .social-tool { --tool-color: var(--social); }
        
        .diversos-btn { background-color: var(--diversos); }
        .diversos-tool { --tool-color: var(--diversos); }

        .chess-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
            width: 100%;
            max-width: 300px;
            margin: 10px auto;
            border: 2px solid #333;
        }
        .chess-square {
            aspect-ratio: 1/1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        .chess-square.light {
            background-color: #f0d9b5;
        }
        .chess-square.dark {
            background-color: #b58863;
        }
        .chess-move-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .chess-move-input input {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .chess-move-input button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
        }
        .settings-title {
            font-weight: 700;
            margin-bottom: 16px;
            font-size: 18px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .slider-container {
            margin: 20px 0;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .slider-value {
            font-weight: bold;
            color: var(--primary);
        }
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            outline: none;
        }
        [data-theme="dark"] input[type="range"] {
            background: #4b5563;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }
        .model-selector {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: 1px solid #d1d5db;
            background: white;
            font-size: 16px;
            color: var(--text);
        }
        [data-theme="dark"] .model-selector {
            background: #1f2937;
            color: white;
            border-color: #4b5563;
        }
        .status-bar {
            display: none;
        }
        .mobile-tabs {
            position: fixed;
            bottom: var(--mobile-footer-height);
            left: 0;
            right: 0;
            display: flex;
            background: white;
            border-top: 1px solid #e5e7eb;
            z-index: 85;
            height: 50px;
        }
        [data-theme="dark"] .mobile-tabs {
            background: #111827;
            border-color: #374151;
        }
        .tab-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            color: var(--text);
        }
        .welcome-message {
            text-align: center;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .welcome-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 700;
        }
        .welcome-text {
            font-size: 1.1rem;
            margin-bottom: 20px;
            color: var(--text);
            opacity: 0.9;
        }
        .features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        .feature-card {
            background: var(--bot-bg);
            border-radius: 16px;
            padding: 15px;
            text-align: center;
        }
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary);
        }
        .feature-title {
            font-size: 1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }
        .feature-description {
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
        }
        .action-btn {
            background: var(--copy-bg);
            border: none;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text);
        }
        .message-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 8px;
            gap: 8px;
        }
        .delete-all-btn {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px;
            font-weight: 600;
            margin: 0 20px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .download-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        @media (min-width: 768px) {
            .features {
                grid-template-columns: repeat(4, 1fr);
            }
            .category-tools {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <div class="logo-icon">V</div>
            <h1>ViBot Ultra</h1>
        </div>
        <div class="header-controls">
            <button class="header-btn" id="toggleTheme">
                <i class="fas fa-moon"></i>
            </button>
            <button class="header-btn" id="menuBtn">
                <i class="fas fa-bars"></i>
            </button>
            <button class="header-btn" id="toolsBtn">
                <i class="fas fa-tools"></i>
            </button>
        </div>
    </header>

    <main>
        <div id="sidebar">
            <button id="newConversationBtn">
                <i class="fas fa-plus"></i> Nova Conversa
            </button>
            <div id="conversationList"></div>
            
            <button class="delete-all-btn" id="deleteAllConversationsBtn">
                <i class="fas fa-trash"></i> Excluir Todas
            </button>
            
            <div class="settings-panel" id="settingsPanel">
                <div class="settings-title"><i class="fas fa-cog"></i> Configurações</div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Modelo:</span>
                    </div>
                    <select id="modelSelector" class="model-selector">
                        <option value="mistral-tiny">ViBot Tiny (Rápido)</option>
                        <option value="mistral-small">ViBot Small (Balanço)</option>
                        <option value="mistral-medium">ViBot Medium (Poderoso)</option>
                    </select>
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Criatividade</span>
                        <span class="slider-value" id="temperatureValue">0.7</span>
                    </div>
                    <input type="range" id="temperatureSlider" min="0" max="2" step="0.1" value="0.7" />
                </div>
                
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Tamanho da Resposta</span>
                        <span class="slider-value" id="maxTokensValue">2000</span>
                    </div>
                    <input type="range" id="maxTokensSlider" min="100" max="4000" step="100" value="2000" />
                </div>
            </div>
        </div>

        <div id="tools-sidebar">
            <div class="tools-panel">
                <!-- Categoria: Produtividade -->
                <div class="category-container">
                    <button class="category-btn produtividade-btn" onclick="toggleCategory('produtividade')">
                        <span><i class="fas fa-briefcase"></i> Produtividade</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools produtividade-tools" id="produtividade-tools">
                        <button class="tools-panel-btn produtividade-tool" id="generateEmailBtn">
                            <i class="fas fa-envelope tools-panel-icon"></i>
                            <span>E-mail</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="summarizeTextBtn">
                            <i class="fas fa-file-alt tools-panel-icon"></i>
                            <span>Resumir</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="translateTextBtn">
                            <i class="fas fa-globe tools-panel-icon"></i>
                            <span>Traduzir</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="improveTextBtn">
                            <i class="fas fa-edit tools-panel-icon"></i>
                            <span>Melhorar</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="generateCodeBtn">
                            <i class="fas fa-code tools-panel-icon"></i>
                            <span>Código</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="generateIdeasBtn">
                            <i class="fas fa-lightbulb tools-panel-icon"></i>
                            <span>Ideias</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="analyzeDataBtn">
                            <i class="fas fa-chart-bar tools-panel-icon"></i>
                            <span>Analisar</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="createContentBtn">
                            <i class="fas fa-pencil-alt tools-panel-icon"></i>
                            <span>Conteúdo</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="explainConceptBtn">
                            <i class="fas fa-book tools-panel-icon"></i>
                            <span>Explicar</span>
                        </button>
                        <button class="tools-panel-btn produtividade-tool" id="solveProblemBtn">
                            <i class="fas fa-search tools-panel-icon"></i>
                            <span>Solucionar</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Criatividade -->
                <div class="category-container">
                    <button class="category-btn criatividade-btn" onclick="toggleCategory('criatividade')">
                        <span><i class="fas fa-paint-brush"></i> Criatividade</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools criatividade-tools" id="criatividade-tools">
                        <button class="tools-panel-btn criatividade-tool" id="generatePoemBtn">
                            <i class="fas fa-pen-fancy tools-panel-icon"></i>
                            <span>Poema</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateStoryBtn">
                            <i class="fas fa-book-open tools-panel-icon"></i>
                            <span>História</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateJokeBtn">
                            <i class="fas fa-laugh tools-panel-icon"></i>
                            <span>Piada</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateScriptBtn">
                            <i class="fas fa-film tools-panel-icon"></i>
                            <span>Roteiro</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateSongBtn">
                            <i class="fas fa-music tools-panel-icon"></i>
                            <span>Música</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateSpeechBtn">
                            <i class="fas fa-microphone tools-panel-icon"></i>
                            <span>Discurso</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateArtBtn">
                            <i class="fas fa-palette tools-panel-icon"></i>
                            <span>Arte</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateDesignBtn">
                            <i class="fas fa-drafting-compass tools-panel-icon"></i>
                            <span>Design</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateBrandingBtn">
                            <i class="fas fa-trademark tools-panel-icon"></i>
                            <span>Branding</span>
                        </button>
                        <button class="tools-panel-btn criatividade-tool" id="generateSloganBtn">
                            <i class="fas fa-quote-right tools-panel-icon"></i>
                            <span>Slogan</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Vida Diária -->
                <div class="category-container">
                    <button class="category-btn vida-diaria-btn" onclick="toggleCategory('vida-diaria')">
                        <span><i class="fas fa-home"></i> Vida Diária</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools vida-diaria-tools" id="vida-diaria-tools">
                        <button class="tools-panel-btn vida-diaria-tool" id="generateRecipeBtn">
                            <i class="fas fa-utensils tools-panel-icon"></i>
                            <span>Receita</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateWorkoutBtn">
                            <i class="fas fa-dumbbell tools-panel-icon"></i>
                            <span>Treino</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateTravelBtn">
                            <i class="fas fa-plane tools-panel-icon"></i>
                            <span>Viagem</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateAdviceBtn">
                            <i class="fas fa-hand-holding-heart tools-panel-icon"></i>
                            <span>Conselho</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateParentingBtn">
                            <i class="fas fa-baby tools-panel-icon"></i>
                            <span>Paternidade</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateFinanceBtn">
                            <i class="fas fa-coins tools-panel-icon"></i>
                            <span>Finanças</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateHealthBtn">
                            <i class="fas fa-heartbeat tools-panel-icon"></i>
                            <span>Saúde</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateDietBtn">
                            <i class="fas fa-apple-alt tools-panel-icon"></i>
                            <span>Dieta</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateShoppingBtn">
                            <i class="fas fa-shopping-cart tools-panel-icon"></i>
                            <span>Compras</span>
                        </button>
                        <button class="tools-panel-btn vida-diaria-tool" id="generateHomeBtn">
                            <i class="fas fa-home tools-panel-icon"></i>
                            <span>Casa</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Educação -->
                <div class="category-container">
                    <button class="category-btn educacao-btn" onclick="toggleCategory('educacao')">
                        <span><i class="fas fa-graduation-cap"></i> Educação</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools educacao-tools" id="educacao-tools">
                        <button class="tools-panel-btn educacao-tool" id="generateQuizBtn">
                            <i class="fas fa-question-circle tools-panel-icon"></i>
                            <span>Quiz</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateFlashcardsBtn">
                            <i class="fas fa-layer-group tools-panel-icon"></i>
                            <span>Flashcards</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateLessonPlanBtn">
                            <i class="fas fa-chalkboard-teacher tools-panel-icon"></i>
                            <span>Plano de Aula</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateStudyPlanBtn">
                            <i class="fas fa-graduation-cap tools-panel-icon"></i>
                            <span>Plano de Estudo</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateHomeworkBtn">
                            <i class="fas fa-book-reader tools-panel-icon"></i>
                            <span>Tarefa</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateEssayBtn">
                            <i class="fas fa-pen tools-panel-icon"></i>
                            <span>Redação</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateThesisBtn">
                            <i class="fas fa-scroll tools-panel-icon"></i>
                            <span>Tese</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateResearchBtn">
                            <i class="fas fa-microscope tools-panel-icon"></i>
                            <span>Pesquisa</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateSummaryBtn">
                            <i class="fas fa-file-contract tools-panel-icon"></i>
                            <span>Resumo</span>
                        </button>
                        <button class="tools-panel-btn educacao-tool" id="generateMathProblemBtn">
                            <i class="fas fa-square-root-alt tools-panel-icon"></i>
                            <span>Problema Matemático</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Negócios -->
                <div class="category-container">
                    <button class="category-btn negocios-btn" onclick="toggleCategory('negocios')">
                        <span><i class="fas fa-chart-line"></i> Negócios</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools negocios-tools" id="negocios-tools">
                        <button class="tools-panel-btn negocios-tool" id="generateBusinessBtn">
                            <i class="fas fa-briefcase tools-panel-icon"></i>
                            <span>Negócios</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateMarketingBtn">
                            <i class="fas fa-bullhorn tools-panel-icon"></i>
                            <span>Marketing</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateSalesBtn">
                            <i class="fas fa-handshake tools-panel-icon"></i>
                            <span>Vendas</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateProposalBtn">
                            <i class="fas fa-file-signature tools-panel-icon"></i>
                            <span>Proposta</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateContractBtn">
                            <i class="fas fa-file-alt tools-panel-icon"></i>
                            <span>Contrato</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateReportBtn">
                            <i class="fas fa-chart-pie tools-panel-icon"></i>
                            <span>Relatório</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateSWOTBtn">
                            <i class="fas fa-chess-board tools-panel-icon"></i>
                            <span>Análise SWOT</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateBusinessPlanBtn">
                            <i class="fas fa-project-diagram tools-panel-icon"></i>
                            <span>Plano de Negócios</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generatePitchBtn">
                            <i class="fas fa-comment-dollar tools-panel-icon"></i>
                            <span>Pitch</span>
                        </button>
                        <button class="tools-panel-btn negocios-tool" id="generateInterviewBtn">
                            <i class="fas fa-comments tools-panel-icon"></i>
                            <span>Entrevista</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Tecnologia -->
                <div class="category-container">
                    <button class="category-btn tecnologia-btn" onclick="toggleCategory('tecnologia')">
                        <span><i class="fas fa-laptop-code"></i> Tecnologia</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools tecnologia-tools" id="tecnologia-tools">
                        <button class="tools-panel-btn tecnologia-tool" id="generateAPIBtn">
                            <i class="fas fa-server tools-panel-icon"></i>
                            <span>API</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateAlgorithmBtn">
                            <i class="fas fa-project-diagram tools-panel-icon"></i>
                            <span>Algoritmo</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateDatabaseBtn">
                            <i class="fas fa-database tools-panel-icon"></i>
                            <span>Banco de Dados</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateUIBtn">
                            <i class="fas fa-desktop tools-panel-icon"></i>
                            <span>Interface</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateMobileAppBtn">
                            <i class="fas fa-mobile-alt tools-panel-icon"></i>
                            <span>App Mobile</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateWebsiteBtn">
                            <i class="fas fa-globe-americas tools-panel-icon"></i>
                            <span>Website</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateGameBtn">
                            <i class="fas fa-gamepad tools-panel-icon"></i>
                            <span>Jogo</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateAIBtn">
                            <i class="fas fa-robot tools-panel-icon"></i>
                            <span>IA</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateBlockchainBtn">
                            <i class="fas fa-link tools-panel-icon"></i>
                            <span>Blockchain</span>
                        </button>
                        <button class="tools-panel-btn tecnologia-tool" id="generateSecurityBtn">
                            <i class="fas fa-shield-alt tools-panel-icon"></i>
                            <span>Segurança</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Entretenimento -->
                <div class="category-container">
                    <button class="category-btn entretenimento-btn" onclick="toggleCategory('entretenimento')">
                        <span><i class="fas fa-film"></i> Entretenimento</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools entretenimento-tools" id="entretenimento-tools">
                        <button class="tools-panel-btn entretenimento-tool" id="generateMovieBtn">
                            <i class="fas fa-film tools-panel-icon"></i>
                            <span>Filme</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateTVShowBtn">
                            <i class="fas fa-tv tools-panel-icon"></i>
                            <span>Série</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateBookBtn">
                            <i class="fas fa-book tools-panel-icon"></i>
                            <span>Livro</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateGameIdeaBtn">
                            <i class="fas fa-dice tools-panel-icon"></i>
                            <span>Ideia de Jogo</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateTriviaBtn">
                            <i class="fas fa-question tools-panel-icon"></i>
                            <span>Trivia</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateDebateBtn">
                            <i class="fas fa-gavel tools-panel-icon"></i>
                            <span>Debate</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generatePodcastBtn">
                            <i class="fas fa-podcast tools-panel-icon"></i>
                            <span>Podcast</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateComedyBtn">
                            <i class="fas fa-theater-masks tools-panel-icon"></i>
                            <span>Comédia</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateHorrorBtn">
                            <i class="fas fa-ghost tools-panel-icon"></i>
                            <span>História de Terror</span>
                        </button>
                        <button class="tools-panel-btn entretenimento-tool" id="generateFantasyBtn">
                            <i class="fas fa-dragon tools-panel-icon"></i>
                            <span>Fantasia</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Especializadas -->
                <div class="category-container">
                    <button class="category-btn especializadas-btn" onclick="toggleCategory('especializadas')">
                        <span><i class="fas fa-atom"></i> Especializadas</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools especializadas-tools" id="especializadas-tools">
                        <button class="tools-panel-btn especializadas-tool" id="chessHelperBtn">
                            <i class="fas fa-chess tools-panel-icon"></i>
                            <span>Xadrez</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateLegalBtn">
                            <i class="fas fa-balance-scale tools-panel-icon"></i>
                            <span>Jurídico</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateMedicalBtn">
                            <i class="fas fa-briefcase-medical tools-panel-icon"></i>
                            <span>Médico</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateEngineeringBtn">
                            <i class="fas fa-cogs tools-panel-icon"></i>
                            <span>Engenharia</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateScienceBtn">
                            <i class="fas fa-atom tools-panel-icon"></i>
                            <span>Ciência</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateMathBtn">
                            <i class="fas fa-square-root-alt tools-panel-icon"></i>
                            <span>Matemática</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateHistoryBtn">
                            <i class="fas fa-landmark tools-panel-icon"></i>
                            <span>História</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generatePhilosophyBtn">
                            <i class="fas fa-brain tools-panel-icon"></i>
                            <span>Filosofia</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generatePsychologyBtn">
                            <i class="fas fa-brain tools-panel-icon"></i>
                            <span>Psicologia</span>
                        </button>
                        <button class="tools-panel-btn especializadas-tool" id="generateAstronomyBtn">
                            <i class="fas fa-meteor tools-panel-icon"></i>
                            <span>Astronomia</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Social -->
                <div class="category-container">
                    <button class="category-btn social-btn" onclick="toggleCategory('social')">
                        <span><i class="fas fa-users"></i> Social</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools social-tools" id="social-tools">
                        <button class="tools-panel-btn social-tool" id="generateSocialMediaBtn">
                            <i class="fas fa-share-alt tools-panel-icon"></i>
                            <span>Mídia Social</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateDatingProfileBtn">
                            <i class="fas fa-heart tools-panel-icon"></i>
                            <span>Perfil de Namoro</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateInvitationBtn">
                            <i class="fas fa-envelope-open-text tools-panel-icon"></i>
                            <span>Convite</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateApologyBtn">
                            <i class="fas fa-hand-holding-heart tools-panel-icon"></i>
                            <span>Pedido de Desculpas</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateComplimentBtn">
                            <i class="fas fa-star tools-panel-icon"></i>
                            <span>Elogio</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateFeedbackBtn">
                            <i class="fas fa-comment-dots tools-panel-icon"></i>
                            <span>Feedback</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateNetworkingBtn">
                            <i class="fas fa-users tools-panel-icon"></i>
                            <span>Networking</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateEventBtn">
                            <i class="fas fa-calendar-alt tools-panel-icon"></i>
                            <span>Evento</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateWeddingBtn">
                            <i class="fas fa-ring tools-panel-icon"></i>
                            <span>Casamento</span>
                        </button>
                        <button class="tools-panel-btn social-tool" id="generateBirthdayBtn">
                            <i class="fas fa-birthday-cake tools-panel-icon"></i>
                            <span>Aniversário</span>
                        </button>
                    </div>
                </div>

                <!-- Categoria: Diversos -->
                <div class="category-container">
                    <button class="category-btn diversos-btn" onclick="toggleCategory('diversos')">
                        <span><i class="fas fa-ellipsis-h"></i> Diversos</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <div class="category-tools diversos-tools" id="diversos-tools">
                        <button class="tools-panel-btn diversos-tool" id="generatePrayerBtn">
                            <i class="fas fa-pray tools-panel-icon"></i>
                            <span>Oração</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateAffirmationBtn">
                            <i class="fas fa-comment tools-panel-icon"></i>
                            <span>Afirmação</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateJournalBtn">
                            <i class="fas fa-book-open tools-panel-icon"></i>
                            <span>Diário</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateBucketListBtn">
                            <i class="fas fa-list-ol tools-panel-icon"></i>
                            <span>Lista de Desejos</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateGratitudeBtn">
                            <i class="fas fa-heart tools-panel-icon"></i>
                            <span>Gratidão</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateVisionBoardBtn">
                            <i class="fas fa-clipboard-list tools-panel-icon"></i>
                            <span>Quadro de Visão</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateGoalSettingBtn">
                            <i class="fas fa-bullseye tools-panel-icon"></i>
                            <span>Definição de Metas</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateProductivityBtn">
                            <i class="fas fa-tasks tools-panel-icon"></i>
                            <span>Produtividade</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateHobbyIdeasBtn">
                            <i class="fas fa-paint-brush tools-panel-icon"></i>
                            <span>Ideias de Hobby</span>
                        </button>
                        <button class="tools-panel-btn diversos-tool" id="generateSelfCareBtn">
                            <i class="fas fa-spa tools-panel-icon"></i>
                            <span>Autocuidado</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="chat-container">
            <div id="chatbox">
                <div class="welcome-message">
                    <div class="welcome-title">Bem-vindo ao ViBot Ultra!</div>
                    <div class="welcome-text">Seu assistente de IA com 100 ferramentas poderosas</div>
                    
                    <div class="features">
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-envelope"></i></div>
                            <div class="feature-title">Gerador de E-mails</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-file-alt"></i></div>
                            <div class="feature-title">Resumos Inteligentes</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-globe"></i></div>
                            <div class="feature-title">Tradução Avançada</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-edit"></i></div>
                            <div class="feature-title">Otimização de Texto</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-code"></i></div>
                            <div class="feature-title">Gerador de Código</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-lightbulb"></i></div>
                            <div class="feature-title">Gerador de Ideias</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
                            <div class="feature-title">Análise de Dados</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-pencil-alt"></i></div>
                            <div class="feature-title">Criação de Conteúdo</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="mobile-tabs">
        <div class="tab-btn" id="chatTabBtn">
            <i class="fas fa-comment"></i>
        </div>
        <div class="tab-btn" id="toolsTabBtn">
            <i class="fas fa-tools"></i>
        </div>
        <div class="tab-btn" id="settingsTabBtn">
            <i class="fas fa-cog"></i>
        </div>
    </div>

    <div id="input-area">
        <div id="input-container">
            <textarea id="userInput" placeholder="Digite sua mensagem..." autocomplete="off" rows="1"></textarea>
            <button id="sendBtn">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        // Função para alternar a exibição das categorias
        function toggleCategory(categoryId) {
            const btn = document.querySelector(`.${categoryId}-btn`);
            const tools = document.getElementById(`${categoryId}-tools`);
            
            btn.classList.toggle('expanded');
            tools.classList.toggle('active');
        }

        const ViBot = {
            config: {
                apiKeys: [
                    "qvoMH8VXJ83lO6vVITjsUIGqZsYLKCI7",  // Sua chave principal
                    "G9h4jBiZ2XXb8IDwq6G15vxNuFw7CB63",  // Fallback 1
                    "sl7gXtaKfUVBHWfbWt5BryOndlpGZ8TR"   // Fallback 2
                ],
                currentApiKeyIndex: 0,
                model: "mistral-tiny",
                temperature: 0.7,
                maxTokens: 2000,
                systemPrompt: "Você é um assistente útil chamado ViBot. Responda de forma clara e concisa no idioma do usuário.",
                apiUrl: "https://api.mistral.ai/v1/chat/completions"
            },

            modelNames: {
                "mistral-tiny": "ViBot Tiny",
                "mistral-small": "ViBot Small", 
                "mistral-medium": "ViBot Medium"
            },

            init() {
                this.cacheElements();
                this.setupEventListeners();
                this.setupInitialState();
                this.updateUI();
            },

            cacheElements() {
                this.elements = {
                    chatbox: document.getElementById("chatbox"),
                    userInput: document.getElementById("userInput"),
                    sendBtn: document.getElementById("sendBtn"),
                    newConversationBtn: document.getElementById("newConversationBtn"),
                    conversationList: document.getElementById("conversationList"),
                    toggleThemeBtn: document.getElementById("toggleTheme"),
                    menuBtn: document.getElementById("menuBtn"),
                    toolsBtn: document.getElementById("toolsBtn"),
                    sidebar: document.getElementById("sidebar"),
                    toolsSidebar: document.getElementById("tools-sidebar"),
                    modelSelector: document.getElementById("modelSelector"),
                    temperatureSlider: document.getElementById("temperatureSlider"),
                    temperatureValue: document.getElementById("temperatureValue"),
                    maxTokensSlider: document.getElementById("maxTokensSlider"),
                    maxTokensValue: document.getElementById("maxTokensValue"),
                    settingsPanel: document.getElementById("settingsPanel"),
                    chatTabBtn: document.getElementById("chatTabBtn"),
                    toolsTabBtn: document.getElementById("toolsTabBtn"),
                    settingsTabBtn: document.getElementById("settingsTabBtn"),
                    deleteAllConversationsBtn: document.getElementById("deleteAllConversationsBtn")
                };

                // Lista de todas as ferramentas
                this.tools = [
                    'generateEmailBtn', 'summarizeTextBtn', 'translateTextBtn', 
                    'improveTextBtn', 'generateCodeBtn', 'generateIdeasBtn', 
                    'analyzeDataBtn', 'createContentBtn', 'explainConceptBtn', 
                    'solveProblemBtn', 'generateRecipeBtn', 'generateWorkoutBtn',
                    'generateTravelBtn', 'generateAdviceBtn', 'generateParentingBtn',
                    'generateFinanceBtn', 'generateHealthBtn', 'generateDietBtn',
                    'generateShoppingBtn', 'generateHomeBtn', 'generateQuizBtn',
                    'generateFlashcardsBtn', 'generateLessonPlanBtn', 'generateStudyPlanBtn',
                    'generateHomeworkBtn', 'generateEssayBtn', 'generateThesisBtn',
                    'generateResearchBtn', 'generateSummaryBtn', 'generateMathProblemBtn',
                    'generateBusinessBtn', 'generateMarketingBtn', 'generateSalesBtn',
                    'generateProposalBtn', 'generateContractBtn', 'generateReportBtn',
                    'generateSWOTBtn', 'generateBusinessPlanBtn', 'generatePitchBtn',
                    'generateInterviewBtn', 'generateAPIBtn', 'generateAlgorithmBtn',
                    'generateDatabaseBtn', 'generateUIBtn', 'generateMobileAppBtn',
                    'generateWebsiteBtn', 'generateGameBtn', 'generateAIBtn',
                    'generateBlockchainBtn', 'generateSecurityBtn', 'generateMovieBtn',
                    'generateTVShowBtn', 'generateBookBtn', 'generateGameIdeaBtn',
                    'generateTriviaBtn', 'generateDebateBtn', 'generatePodcastBtn',
                    'generateComedyBtn', 'generateHorrorBtn', 'generateFantasyBtn',
                    'chessHelperBtn', 'generateLegalBtn', 'generateMedicalBtn',
                    'generateEngineeringBtn', 'generateScienceBtn', 'generateMathBtn',
                    'generateHistoryBtn', 'generatePhilosophyBtn', 'generatePsychologyBtn',
                    'generateAstronomyBtn', 'generateSocialMediaBtn', 'generateDatingProfileBtn',
                    'generateInvitationBtn', 'generateApologyBtn', 'generateComplimentBtn',
                    'generateFeedbackBtn', 'generateNetworkingBtn', 'generateEventBtn',
                    'generateWeddingBtn', 'generateBirthdayBtn', 'generatePrayerBtn',
                    'generateAffirmationBtn', 'generateJournalBtn', 'generateBucketListBtn',
                    'generateGratitudeBtn', 'generateVisionBoardBtn', 'generateGoalSettingBtn',
                    'generateProductivityBtn', 'generateHobbyIdeasBtn', 'generateSelfCareBtn',
                    'generatePoemBtn', 'generateStoryBtn', 'generateJokeBtn',
                    'generateScriptBtn', 'generateSongBtn', 'generateSpeechBtn',
                    'generateArtBtn', 'generateDesignBtn', 'generateBrandingBtn',
                    'generateSloganBtn'
                ];
                
                // Cache all buttons
                this.tools.forEach(button => {
                    this.elements[button] = document.getElementById(button);
                });

                this.typingIndicator = document.createElement("div");
                this.typingIndicator.className = "message bot typing";
                this.typingIndicator.textContent = "ViBot está digitando...";
            },

            setupEventListeners() {
                // Enviar mensagem ao pressionar Enter (mas Shift+Enter para nova linha)
                this.elements.userInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });

                // Enviar mensagem ao clicar no botão
                this.elements.sendBtn.addEventListener('click', () => this.sendMessage());
                
                // Auto-resize textarea
                this.elements.userInput.addEventListener('input', () => {
                    this.elements.userInput.style.height = 'auto';
                    this.elements.userInput.style.height = Math.min(this.elements.userInput.scrollHeight, 150) + 'px';
                });
                
                // Navigation
                this.elements.newConversationBtn.addEventListener('click', () => this.createNewConversation());
                this.elements.toggleThemeBtn.addEventListener('click', () => this.toggleTheme());
                this.elements.menuBtn.addEventListener('click', () => this.toggleSidebar());
                this.elements.toolsBtn.addEventListener('click', () => this.toggleToolsSidebar());
                this.elements.modelSelector.addEventListener('change', e => this.updateModel(e.target.value));
                this.elements.temperatureSlider.addEventListener('input', e => this.updateTemperature(e.target.value));
                this.elements.maxTokensSlider.addEventListener('input', e => this.updateMaxTokens(e.target.value));
                this.elements.deleteAllConversationsBtn.addEventListener('click', () => this.deleteAllConversations());
                
                // Tabs
                this.elements.chatTabBtn.addEventListener('click', () => this.showTab('chat'));
                this.elements.toolsTabBtn.addEventListener('click', () => this.showTab('tools'));
                this.elements.settingsTabBtn.addEventListener('click', () => this.showTab('settings'));

                // Tool buttons
                this.tools.forEach(tool => {
                    if (this.elements[tool]) {
                        this.elements[tool].addEventListener('click', () => this.handleToolClick(tool));
                    }
                });
            },

            setupInitialState() {
                this.conversations = {};
                this.currentConversationId = null;
                this.totalTokens = 0;
                this.chessBoard = null;

                this.loadTheme();
                this.createNewConversation();
            },

            updateUI() {
                this.elements.temperatureValue.textContent = this.config.temperature;
                this.elements.maxTokensValue.textContent = this.config.maxTokens;
            },

            loadTheme() {
                const theme = localStorage.getItem("vibot_theme") || "light";
                document.documentElement.setAttribute("data-theme", theme);
                
                // Update theme icon
                const icon = this.elements.toggleThemeBtn.querySelector('i');
                if (theme === "dark") {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                }
            },

            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute("data-theme");
                const newTheme = currentTheme === "dark" ? "light" : "dark";
                document.documentElement.setAttribute("data-theme", newTheme);
                localStorage.setItem("vibot_theme", newTheme);
                
                // Update theme icon
                const icon = this.elements.toggleThemeBtn.querySelector('i');
                if (newTheme === "dark") {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                }
            },

            toggleSidebar() {
                this.elements.sidebar.classList.toggle('active');
                this.elements.toolsSidebar.classList.remove('active');
            },

            toggleToolsSidebar() {
                this.elements.toolsSidebar.classList.toggle('active');
                this.elements.sidebar.classList.remove('active');
            },

            updateModel(model) {
                // Verifica se o modelo é suportado
                if (Object.keys(this.modelNames).includes(model)) {
                    this.config.model = model;
                    
                    // Ajusta maxTokens baseado no modelo
                    if (model === "mistral-tiny") {
                        this.config.maxTokens = 2000;
                    } else {
                        this.config.maxTokens = 4000; // Aumenta para modelos maiores
                    }
                    
                    // Atualiza o slider na UI
                    this.elements.maxTokensSlider.value = this.config.maxTokens;
                    this.elements.maxTokensValue.textContent = this.config.maxTokens;
                }
            },

            updateTemperature(value) {
                this.config.temperature = parseFloat(value);
                this.elements.temperatureValue.textContent = this.config.temperature;
            },

            updateMaxTokens(value) {
                this.config.maxTokens = parseInt(value);
                this.elements.maxTokensValue.textContent = this.config.maxTokens;
            },

            showTab(tabName) {
                if (tabName === 'tools') {
                    this.toggleToolsSidebar();
                } else if (tabName === 'settings') {
                    this.toggleSidebar();
                } else {
                    this.elements.userInput.focus();
                }
            },

            createNewConversation() {
                const id = "conv_" + Date.now();
                this.conversations[id] = {
                    id,
                    title: "Nova Conversa",
                    messages: [],
                    createdAt: Date.now()
                };
                
                this.currentConversationId = id;
                this.renderConversationsList();
                this.renderCurrentConversation();
                this.elements.userInput.focus();
            },

            deleteAllConversations() {
                if (confirm("Tem certeza que deseja excluir TODAS as conversas? Esta ação não pode ser desfeita.")) {
                    this.conversations = {};
                    this.createNewConversation();
                    this.elements.sidebar.classList.remove('active');
                }
            },

            deleteConversation(id) {
                if (confirm("Tem certeza que deseja excluir esta conversa?")) {
                    delete this.conversations[id];
                    
                    if (this.currentConversationId === id) {
                        if (Object.keys(this.conversations).length > 0) {
                            this.currentConversationId = Object.keys(this.conversations)[0];
                        } else {
                            this.createNewConversation();
                        }
                    }
                    
                    this.renderConversationsList();
                    this.renderCurrentConversation();
                }
            },

            renderConversationsList() {
                this.elements.conversationList.innerHTML = "";
                
                Object.values(this.conversations)
                    .sort((a, b) => b.createdAt - a.createdAt)
                    .forEach(conversation => {
                        const btn = document.createElement("button");
                        btn.className = `conversation-btn ${conversation.id === this.currentConversationId ? "active" : ""}`;
                        btn.innerHTML = `
                            <i class="fas fa-comment conversation-icon"></i>
                            <span>${conversation.title}</span>
                            <button class="conversation-delete" data-id="${conversation.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        `;
                        
                        btn.onclick = () => {
                            this.switchConversation(conversation.id);
                            this.elements.sidebar.classList.remove('active');
                        };
                        
                        const deleteBtn = btn.querySelector('.conversation-delete');
                        deleteBtn.onclick = (e) => {
                            e.stopPropagation();
                            this.deleteConversation(conversation.id);
                        };
                        
                        this.elements.conversationList.appendChild(btn);
                    });
            },

            switchConversation(id) {
                this.currentConversationId = id;
                this.renderConversationsList();
                this.renderCurrentConversation();
            },

            renderCurrentConversation() {
                this.elements.chatbox.innerHTML = "";
                
                const conversation = this.conversations[this.currentConversationId];
                
                if (conversation.messages.length === 0) {
                    this.addMessage("bot", "Olá! Sou o ViBot, seu assistente de IA com 100 ferramentas. Como posso te ajudar hoje?");
                } else {
                    conversation.messages.forEach(msg => {
                        this.addMessageToChatbox(msg.role === "assistant" ? "bot" : "user", msg.content);
                    });
                }
                
                this.elements.chatbox.scrollTop = this.elements.chatbox.scrollHeight;
            },

            async sendMessage() {
                const message = this.elements.userInput.value.trim();
                if (!message) return;
                
                const conversation = this.conversations[this.currentConversationId];
                
                this.addMessage("user", message);
                this.elements.userInput.value = "";
                this.elements.userInput.style.height = 'auto';
                
                this.elements.chatbox.appendChild(this.typingIndicator);
                this.elements.chatbox.scrollTop = this.elements.chatbox.scrollHeight;
                
                try {
                    // Verifica se é um comando de xadrez
                    if (message.toLowerCase().startsWith("xadrez") || message.toLowerCase().startsWith("chess")) {
                        const command = message.substring(message.indexOf(" ") + 1);
                        const response = this.handleChessCommand(command);
                        this.typingIndicator.remove();
                        this.addMessage("bot", response);
                        return;
                    }

                    const messages = [
                        { role: "system", content: this.config.systemPrompt },
                        ...conversation.messages.map(msg => ({
                            role: msg.role === "bot" ? "assistant" : msg.role,
                            content: this.getTextContent(msg.content)
                        }))
                    ];
                    
                    // Validação reforçada dos parâmetros
                    const safeMaxTokens = Math.max(128, Math.min(parseInt(this.config.maxTokens), 16384));
                    const safeTemperature = Math.max(0.1, Math.min(parseFloat(this.config.temperature), 2.0));
                    
                    // Tentar com cada API até obter sucesso
                    let response;
                    let lastError;
                    
                    for (let i = 0; i < this.config.apiKeys.length; i++) {
                        this.config.currentApiKeyIndex = i;
                        const currentApiKey = this.config.apiKeys[i];
                        
                        try {
                            response = await fetch(this.config.apiUrl, {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                    "Authorization": `Bearer ${currentApiKey}`
                                },
                                body: JSON.stringify({
                                    model: this.config.model,
                                    messages: messages,
                                    temperature: safeTemperature,
                                    max_tokens: safeMaxTokens,
                                    stream: false
                                })
                            });
                            
                            if (!response.ok) {
                                const errorData = await response.json();
                                lastError = new Error(`Erro na API (chave ${i+1}): ${response.status} - ${errorData.error?.message || 'Sem detalhes'}`);
                                continue; // Tenta a próxima API
                            }
                            
                            // Se chegou aqui, a resposta foi bem-sucedida
                            break;
                        } catch (error) {
                            lastError = error;
                            continue; // Tenta a próxima API
                        }
                    }
                    
                    if (!response || !response.ok) {
                        throw lastError || new Error("Todas as tentativas com as APIs falharam");
                    }
                    
                    const data = await response.json();
                    const botMessage = data.choices[0].message.content;
                    
                    this.typingIndicator.remove();
                    this.addMessage("bot", botMessage);
                    
                    this.totalTokens += data.usage?.total_tokens || 0;
                } catch (error) {
                    this.typingIndicator.remove();
                    this.addMessage("bot", `⚠️ Erro: ${error.message}`, "error");
                    console.error("Erro completo:", error);
                }
            },

            addMessage(role, content, type = null) {
                const conversation = this.conversations[this.currentConversationId];
                const messageObj = {
                    role: role === "bot" ? "assistant" : "user",
                    content: content,
                    timestamp: Date.now()
                };
                
                conversation.messages.push(messageObj);
                
                // Atualiza o título da conversa se for a primeira mensagem do usuário
                if (role === "user" && conversation.messages.length === 1) {
                    conversation.title = content.length > 30 ? content.substring(0, 30) + "..." : content;
                    this.renderConversationsList();
                }
                
                this.addMessageToChatbox(role, content, type);
                this.elements.chatbox.scrollTop = this.elements.chatbox.scrollHeight;
            },

            addMessageToChatbox(role, content, type = null) {
                const messageDiv = document.createElement("div");
                messageDiv.className = `message ${role}`;
                if (type) messageDiv.classList.add(type);
                messageDiv.innerHTML = content;
                
                const actionsDiv = document.createElement("div");
                actionsDiv.className = "message-actions";
                
                const copyBtn = document.createElement("button");
                copyBtn.className = "action-btn";
                copyBtn.innerHTML = `<i class="fas fa-copy"></i> Copiar`;
                copyBtn.onclick = () => {
                    navigator.clipboard.writeText(this.getTextContent(content));
                    copyBtn.innerHTML = `<i class="fas fa-check"></i> Copiado!`;
                    setTimeout(() => {
                        copyBtn.innerHTML = `<i class="fas fa-copy"></i> Copiar`;
                    }, 2000);
                };
                actionsDiv.appendChild(copyBtn);
                
                // Adiciona botão de download
                const downloadBtn = document.createElement("button");
                downloadBtn.className = "download-btn";
                downloadBtn.innerHTML = `<i class="fas fa-download"></i> Baixar`;
                downloadBtn.onclick = () => {
                    this.downloadText(content);
                };
                actionsDiv.appendChild(downloadBtn);
                
                messageDiv.appendChild(actionsDiv);
                this.elements.chatbox.appendChild(messageDiv);
            },

            downloadText(content) {
                const text = this.getTextContent(content);
                const blob = new Blob([text], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `vibot-mensagem-${new Date().toISOString().slice(0, 10)}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            },

            getTextContent(html) {
                const temp = document.createElement('div');
                temp.innerHTML = html;
                return temp.textContent || temp.innerText || '';
            },
            
            handleToolClick(toolId) {
                const toolPrompts = {
                    // Produtividade
                    generateEmailBtn: `Por favor, gere um e-mail profissional com base nas informações que eu fornecer.`,
                    summarizeTextBtn: `Por favor, resuma o seguinte texto mantendo os pontos principais.`,
                    translateTextBtn: `Por favor, traduza o seguinte texto para o idioma que eu especificar.`,
                    improveTextBtn: `Por favor, revise e melhore o seguinte texto, tornando-o mais claro e profissional.`,
                    generateCodeBtn: `Por favor, gere código com base nas especificações que eu fornecer.`,
                    generateIdeasBtn: `Por favor, gere ideias criativas com base no tema que eu fornecer.`,
                    analyzeDataBtn: `Por favor, analise os dados que eu fornecer e extraia insights relevantes.`,
                    createContentBtn: `Por favor, crie conteúdo de qualidade com base no tópico que eu fornecer.`,
                    explainConceptBtn: `Por favor, explique este conceito de forma clara e didática.`,
                    solveProblemBtn: `Por favor, me ajude a solucionar este problema com uma abordagem passo a passo.`,
                    
                    // Vida Diária
                    generateRecipeBtn: `Por favor, sugira uma receita com os ingredientes que eu mencionar.`,
                    generateWorkoutBtn: `Por favor, crie um plano de treino para o objetivo que eu especificar.`,
                    generateTravelBtn: `Por favor, planeje um roteiro de viagem para o destino que eu especificar.`,
                    generateAdviceBtn: `Por favor, dê um conselho útil sobre a situação que eu descrever.`,
                    generateParentingBtn: `Por favor, dê conselhos para pais sobre o tópico que eu mencionar.`,
                    generateFinanceBtn: `Por favor, dê conselhos financeiros para a situação que eu descrever.`,
                    generateHealthBtn: `Por favor, dê conselhos de saúde para a condição que eu mencionar.`,
                    generateDietBtn: `Por favor, sugira um plano alimentar para o objetivo que eu especificar.`,
                    generateShoppingBtn: `Por favor, sugira itens para comprar com base nas minhas necessidades.`,
                    generateHomeBtn: `Por favor, dê dicas para organizar/decoração da casa com base no meu espaço.`,
                    
                    // Educação
                    generateQuizBtn: `Por favor, crie um quiz sobre o tópico que eu mencionar.`,
                    generateFlashcardsBtn: `Por favor, crie flashcards para ajudar no estudo do assunto que eu mencionar.`,
                    generateLessonPlanBtn: `Por favor, ajude a criar um plano de aula para o tópico que eu mencionar.`,
                    generateStudyPlanBtn: `Por favor, ajude a criar um plano de estudos personalizado.`,
                    generateHomeworkBtn: `Por favor, sugira exercícios para praticar o tópico que eu mencionar.`,
                    generateEssayBtn: `Por favor, ajude a estruturar uma redação sobre o tema que eu mencionar.`,
                    generateThesisBtn: `Por favor, ajude a estruturar uma tese acadêmica.`,
                    generateResearchBtn: `Por favor, sugira metodologias de pesquisa para o tema que eu mencionar.`,
                    generateSummaryBtn: `Por favor, resuma o conteúdo que eu fornecer.`,
                    generateMathProblemBtn: `Por favor, crie problemas matemáticos sobre o tópico que eu mencionar.`,
                    
                    // Negócios
                    generateBusinessBtn: `Por favor, dê conselhos para o negócio que eu descrever.`,
                    generateMarketingBtn: `Por favor, sugira estratégias de marketing para o produto/serviço que eu mencionar.`,
                    generateSalesBtn: `Por favor, sugira técnicas de vendas para o cenário que eu descrever.`,
                    generateProposalBtn: `Por favor, ajude a criar uma proposta comercial.`,
                    generateContractBtn: `Por favor, ajude a redigir um contrato para a situação que eu descrever.`,
                    generateReportBtn: `Por favor, ajude a estruturar um relatório sobre o assunto que eu mencionar.`,
                    generateSWOTBtn: `Por favor, faça uma análise SWOT para o negócio que eu descrever.`,
                    generateBusinessPlanBtn: `Por favor, ajude a estruturar um plano de negócios.`,
                    generatePitchBtn: `Por favor, ajude a criar um pitch para investidores.`,
                    generateInterviewBtn: `Por favor, prepare perguntas para uma entrevista sobre o tópico que eu fornecer.`,
                    
                    // Tecnologia
                    generateAPIBtn: `Por favor, ajude a projetar uma API para o sistema que eu descrever.`,
                    generateAlgorithmBtn: `Por favor, sugira algoritmos para resolver o problema que eu descrever.`,
                    generateDatabaseBtn: `Por favor, ajude a modelar um banco de dados para o sistema que eu mencionar.`,
                    generateUIBtn: `Por favor, sugira designs de interface para o aplicativo que eu descrever.`,
                    generateMobileAppBtn: `Por favor, ajude a planejar um aplicativo móvel.`,
                    generateWebsiteBtn: `Por favor, ajude a planejar um website.`,
                    generateGameBtn: `Por favor, ajude a projetar um jogo.`,
                    generateAIBtn: `Por favor, sugira abordagens de IA para o problema que eu descrever.`,
                    generateBlockchainBtn: `Por favor, explique como blockchain poderia ser aplicado ao cenário que eu mencionar.`,
                    generateSecurityBtn: `Por favor, sugira medidas de segurança para o sistema que eu descrever.`,
                    
                    // Entretenimento
                    generateMovieBtn: `Por favor, sugira ideias para um filme baseado no tema que eu mencionar.`,
                    generateTVShowBtn: `Por favor, sugira ideias para uma série de TV.`,
                    generateBookBtn: `Por favor, sugira ideias para um livro.`,
                    generateGameIdeaBtn: `Por favor, sugira ideias para um jogo.`,
                    generateTriviaBtn: `Por favor, crie perguntas de trivia sobre o tópico que eu mencionar.`,
                    generateDebateBtn: `Por favor, sugira tópicos para debate sobre o assunto que eu mencionar.`,
                    generatePodcastBtn: `Por favor, sugira ideias para um podcast.`,
                    generateComedyBtn: `Por favor, crie conteúdo humorístico sobre o tema que eu mencionar.`,
                    generateHorrorBtn: `Por favor, crie uma história de terror.`,
                    generateFantasyBtn: `Por favor, crie uma história de fantasia.`,
                    
                    // Especializadas
                    chessHelperBtn: `Vamos jogar xadrez! Você pode me ajudar analisando posições, sugerindo movimentos ou explicando conceitos. Digite "ajuda" para ver os comandos disponíveis.`,
                    generateLegalBtn: `Por favor, dê orientações jurídicas sobre o assunto que eu mencionar.`,
                    generateMedicalBtn: `Por favor, dê informações médicas sobre o sintoma/condição que eu mencionar.`,
                    generateEngineeringBtn: `Por favor, sugira soluções de engenharia para o problema que eu descrever.`,
                    generateScienceBtn: `Por favor, explique o conceito científico que eu mencionar.`,
                    generateMathBtn: `Por favor, explique o conceito matemático que eu mencionar.`,
                    generateHistoryBtn: `Por favor, conte sobre o evento histórico que eu mencionar.`,
                    generatePhilosophyBtn: `Por favor, discuta o conceito filosófico que eu mencionar.`,
                    generatePsychologyBtn: `Por favor, explique o conceito psicológico que eu mencionar.`,
                    generateAstronomyBtn: `Por favor, explique o conceito astronômico que eu mencionar.`,
                    
                    // Social
                    generateSocialMediaBtn: `Por favor, sugira conteúdo para mídias sociais sobre o tópico que eu mencionar.`,
                    generateDatingProfileBtn: `Por favor, ajude a criar um perfil de namoro atraente.`,
                    generateInvitationBtn: `Por favor, ajude a redigir um convite para o evento que eu mencionar.`,
                    generateApologyBtn: `Por favor, ajude a redigir um pedido de desculpas.`,
                    generateComplimentBtn: `Por favor, ajude a formular um elogio.`,
                    generateFeedbackBtn: `Por favor, ajude a estruturar um feedback construtivo.`,
                    generateNetworkingBtn: `Por favor, sugira abordagens para networking no contexto que eu mencionar.`,
                    generateEventBtn: `Por favor, ajude a planejar um evento.`,
                    generateWeddingBtn: `Por favor, ajude a planejar um casamento.`,
                    generateBirthdayBtn: `Por favor, ajude a planejar uma festa de aniversário.`,
                    
                    // Diversos
                    generatePrayerBtn: `Por favor, ajude a redigir uma oração sobre o tema que eu mencionar.`,
                    generateAffirmationBtn: `Por favor, crie afirmações positivas sobre o tema que eu mencionar.`,
                    generateJournalBtn: `Por favor, sugira tópicos para registro em diário.`,
                    generateBucketListBtn: `Por favor, sugira itens para uma lista de coisas para fazer antes de morrer.`,
                    generateGratitudeBtn: `Por favor, sugira coisas pelas quais ser grato.`,
                    generateVisionBoardBtn: `Por favor, sugira elementos para um quadro de visão.`,
                    generateGoalSettingBtn: `Por favor, ajude a definir metas SMART.`,
                    generateProductivityBtn: `Por favor, sugira técnicas de produtividade.`,
                    generateHobbyIdeasBtn: `Por favor, sugira hobbies baseados nos meus interesses.`,
                    generateSelfCareBtn: `Por favor, sugira práticas de autocuidado.`,
                    
                    // Criatividade
                    generatePoemBtn: `Por favor, escreva um poema sobre o tema que eu fornecer.`,
                    generateStoryBtn: `Por favor, crie uma história interessante com base no tema que eu fornecer.`,
                    generateJokeBtn: `Por favor, conte uma piada sobre o assunto que eu mencionar.`,
                    generateScriptBtn: `Por favor, escreva um roteiro para o cenário que eu descrever.`,
                    generateSongBtn: `Por favor, componha uma letra de música no estilo que eu especificar.`,
                    generateSpeechBtn: `Por favor, escreva um discurso sobre o tema que eu mencionar.`,
                    generateArtBtn: `Por favor, descreva uma obra de arte baseada na minha descrição.`,
                    generateDesignBtn: `Por favor, sugira um design com base nos requisitos que eu fornecer.`,
                    generateBrandingBtn: `Por favor, crie uma identidade de marca para o negócio que eu descrever.`,
                    generateSloganBtn: `Por favor, crie slogans criativos para o produto/marca que eu mencionar.`
                };

                const prompt = toolPrompts[toolId] || `Por favor, execute a ferramenta ${toolId.replace('Btn', '')} com base nas informações que eu fornecer.`;
                
                // Mostra o prompt na área de entrada
                this.elements.userInput.value = prompt;
                this.elements.userInput.focus();
                this.elements.toolsSidebar.classList.remove('active');
                
                // Rola para a área de entrada
                setTimeout(() => {
                    this.elements.userInput.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            },

            // Função especial para o assistente de xadrez
            handleChessCommand(command) {
                if (!this.chessBoard) {
                    this.chessBoard = this.createInitialChessBoard();
                }
                
                command = command.toLowerCase().trim();
                
                if (command === 'ajuda') {
                    return `
                        <h3>Assistente de Xadrez - Comandos Disponíveis:</h3>
                        <ul>
                            <li><strong>tabuleiro</strong>: Mostra a posição atual do tabuleiro</li>
                            <li><strong>novo jogo</strong>: Reinicia o jogo</li>
                            <li><strong>mover [origem]-[destino]</strong>: Exemplo: "mover e2-e4"</li>
                            <li><strong>analisar</strong>: Analisa a posição atual</li>
                            <li><strong>melhor movimento</strong>: Sugere o melhor movimento</li>
                            <li><strong>aberturas</strong>: Explica aberturas de xadrez</li>
                            <li><strong>finais</strong>: Explica finais de jogo</li>
                            <li><strong>táticas</strong>: Explica táticas comuns</li>
                            <li><strong>história</strong>: Conta sobre a história do xadrez</li>
                        </ul>
                    `;
                } else if (command === 'tabuleiro') {
                    return this.renderChessBoard();
                } else if (command === 'novo jogo') {
                    this.chessBoard = this.createInitialChessBoard();
                    return 'Novo jogo iniciado! ' + this.renderChessBoard();
                } else if (command.startsWith('mover')) {
                    const move = command.split(' ')[1];
                    return this.handleChessMove(move);
                } else if (command === 'analisar') {
                    return this.analyzeChessPosition();
                } else if (command === 'melhor movimento') {
                    return this.suggestBestMove();
                } else if (command === 'aberturas') {
                    return this.explainChessOpenings();
                } else if (command === 'finais') {
                    return this.explainChessEndgames();
                } else if (command === 'táticas') {
                    return this.explainChessTactics();
                } else if (command === 'história') {
                    return this.tellChessHistory();
                } else {
                    return 'Comando não reconhecido. Digite "ajuda" para ver os comandos disponíveis.';
                }
            },

            createInitialChessBoard() {
                // Cria um tabuleiro de xadrez inicial
                return {
                    board: [
                        ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
                        ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
                        [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
                        [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
                        [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
                        [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
                        ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
                        ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
                    ],
                    turn: 'white',
                    moveHistory: [],
                    capturedPieces: {
                        white: [],
                        black: []
                    }
                };
            },

            renderChessBoard() {
                const pieceSymbols = {
                    'K': '♔', 'Q': '♕', 'R': '♖', 'B': '♗', 'N': '♘', 'P': '♙',
                    'k': '♚', 'q': '♛', 'r': '♜', 'b': '♝', 'n': '♞', 'p': '♟'
                };
                
                let boardHtml = '<div class="chess-board">';
                
                for (let i = 0; i < 8; i++) {
                    for (let j = 0; j < 8; j++) {
                        const piece = this.chessBoard.board[i][j];
                        const pieceSymbol = pieceSymbols[piece] || ' ';
                        const colorClass = (i + j) % 2 === 0 ? 'light' : 'dark';
                        
                        boardHtml += `
                            <div class="chess-square ${colorClass}">
                                ${pieceSymbol}
                            </div>
                        `;
                    }
                }
                
                boardHtml += '</div>';
                boardHtml += `
                    <div class="chess-move-input">
                        <input type="text" id="chessMoveInput" placeholder="Ex: e2-e4">
                        <button onclick="ViBot.submitChessMove()">Mover</button>
                    </div>
                `;
                
                return boardHtml;
            },

            submitChessMove() {
                const moveInput = document.getElementById('chessMoveInput');
                const move = moveInput.value.trim();
                
                if (move) {
                    this.addMessage('user', `mover ${move}`);
                    const response = this.handleChessMove(move);
                    this.addMessage('bot', response);
                }
            },

            handleChessMove(move) {
                // Implementação simplificada - em um sistema real, seria mais complexo
                try {
                    const [from, to] = move.split('-');
                    
                    if (!from || !to || from.length !== 2 || to.length !== 2) {
                        return 'Formato inválido. Use "mover [origem]-[destino]", exemplo: "mover e2-e4"';
                    }
                    
                    const fromCol = from.charCodeAt(0) - 'a'.charCodeAt(0);
                    const fromRow = 8 - parseInt(from[1]);
                    const toCol = to.charCodeAt(0) - 'a'.charCodeAt(0);
                    const toRow = 8 - parseInt(to[1]);
                    
                    if (fromCol < 0 || fromCol > 7 || fromRow < 0 || fromRow > 7 ||
                        toCol < 0 || toCol > 7 || toRow < 0 || toRow > 7) {
                        return 'Posição inválida. As colunas vão de a-h e as linhas de 1-8.';
                    }
                    
                    const piece = this.chessBoard.board[fromRow][fromCol];
                    
                    if (piece === ' ') {
                        return 'Não há peça na posição de origem.';
                    }
                    
                    // Verifica se é a vez do jogador correto
                    const isWhiteTurn = this.chessBoard.turn === 'white';
                    const isWhitePiece = piece === piece.toUpperCase();
                    
                    if ((isWhiteTurn && !isWhitePiece) || (!isWhiteTurn && isWhitePiece)) {
                        return `Não é a vez das ${isWhitePiece ? 'brancas' : 'pretas'} jogarem.`;
                    }
                    
                    // Move a peça (implementação simplificada)
                    const capturedPiece = this.chessBoard.board[toRow][toCol];
                    
                    if (capturedPiece !== ' ') {
                        const color = this.chessBoard.turn;
                        this.chessBoard.capturedPieces[color].push(capturedPiece);
                    }
                    
                    this.chessBoard.board[toRow][toCol] = piece;
                    this.chessBoard.board[fromRow][fromCol] = ' ';
                    this.chessBoard.moveHistory.push(move);
                    this.chessBoard.turn = this.chessBoard.turn === 'white' ? 'black' : 'white';
                    
                    return `Movimento realizado: ${move}. ${this.renderChessBoard()}`;
                } catch (e) {
                    return `Erro ao processar movimento: ${e.message}`;
                }
            },

            analyzeChessPosition() {
                // Análise simplificada da posição atual
                let analysis = '<h3>Análise da Posição Atual:</h3><ul>';
                
                // Conta peças
                const pieceCount = { white: 0, black: 0 };
                for (let i = 0; i < 8; i++) {
                    for (let j = 0; j < 8; j++) {
                        const piece = this.chessBoard.board[i][j];
                        if (piece !== ' ') {
                            if (piece === piece.toUpperCase()) {
                                pieceCount.white++;
                            } else {
                                pieceCount.black++;
                            }
                        }
                    }
                }
                
                analysis += `<li>Material: Brancas ${pieceCount.white} x ${pieceCount.black} Pretas</li>`;
                analysis += `<li>Vez: ${this.chessBoard.turn === 'white' ? 'Brancas' : 'Pretas'}</li>`;
                analysis += `<li>Movimentos realizados: ${this.chessBoard.moveHistory.length}</li>`;
                analysis += '</ul>';
                
                return analysis + this.renderChessBoard();
            },

            suggestBestMove() {
                // Sugere um movimento aleatório (em um sistema real, usaria um algoritmo)
                const possibleMoves = [
                    'e2-e4', 'd2-d4', 'g1-f3', 'b1-c3', 'f2-f4',
                    'e7-e5', 'd7-d5', 'g8-f6', 'b8-c6', 'f7-f5'
                ];
                
                const randomMove = possibleMoves[Math.floor(Math.random() * possibleMoves.length)];
                return `Sugestão de movimento: ${randomMove}. Você pode executá-lo digitando "mover ${randomMove}".`;
            },

            explainChessOpenings() {
                return `
                    <h3>Aberturas de Xadrez</h3>
                    <p>As aberturas são os primeiros movimentos do jogo, onde você desenvolve suas peças e controla o centro.</p>
                    
                    <h4>Aberturas Populares:</h4>
                    <ul>
                        <li><strong>Ruy López (1.e4 e5 2.Cf3 Cc6 3.Bb5)</strong>: Uma das aberturas mais antigas e analisadas.</li>
                        <li><strong>Siciliana (1.e4 c5)</strong>: Defesa agressiva para as pretas contra 1.e4.</li>
                        <li><strong>Francesa (1.e4 e6)</strong>: Defesa sólida que leva a estruturas de peões complexas.</li>
                        <li><strong>Índia do Rei (1.d4 Cf6 2.c4 g6)</strong>: Defesa flexível que pode levar a ataques no flanco do rei.</li>
                        <li><strong>Gambito da Dama (1.d4 d5 2.c4)</strong>: Abertura clássica onde as brancas sacrificam um peão para obter iniciativa.</li>
                    </ul>
                    
                    <p>Dica: Estude algumas aberturas básicas e tente entender os planos estratégicos por trás delas.</p>
                `;
            },

            explainChessEndgames() {
                return `
                    <h3>Finais de Xadrez</h3>
                    <p>Os finais ocorrem quando poucas peças restam no tabuleiro. Conhecimento de finais é crucial para converter vantagens.</p>
                    
                    <h4>Finais Básicos:</h4>
                    <ul>
                        <li><strong>Rei e Dama vs Rei</strong>: O mais simples, mate em no máximo 10 movimentos.</li>
                        <li><strong>Rei e Torre vs Rei</strong>: Mate em no máximo 16 movimentos.</li>
                        <li><strong>Rei e 2 Bispos vs Rei</strong>: Mate forçado, requer precisão.</li>
                        <li><strong>Rei, Bispo e Cavalo vs Rei</strong>: Mate mais complexo, limite de 33 movimentos.</li>
                        <li><strong>Peões</strong>: Finais de peões dependem da capacidade de promoção.</li>
                    </ul>
                    
                    <p>Dica: Pratique finais básicos regularmente - eles podem decidir muitas partidas.</p>
                `;
            },

            explainChessTactics() {
                return `
                    <h3>Táticas de Xadrez</h3>
                    <p>Táticas são manobras de curto prazo que aproveitam erros do oponente para ganhar vantagem material ou posicional.</p>
                    
                    <h4>Táticas Comuns:</h4>
                    <ul>
                        <li><strong>Garfo</strong>: Uma peça ataca duas ou mais peças inimigas simultaneamente.</li>
                        <li><strong>Pino</strong>: Uma peça é "preso" porque mover-se exporia uma peça mais valiosa.</li>
                        <li><strong>Descoberta</strong>: Mover uma peça revela um ataque de outra peça.</li>
                        <li><strong>Xeque descoberto</strong>: Tipo especial de descoberta que resulta em xeque.</li>
                        <li><strong>Skewer</strong>: Similar ao pino, mas a peça mais valiosa está na frente.</li>
                        <li><strong>Defesa insuficiente</strong>: Uma peça está defendendo múltiplas ameaças.</li>
                        <li><strong>Sacrifício</strong>: Dar material para obter vantagem posicional ou ataque.</li>
                    </ul>
                    
                    <p>Dica: Resolver problemas táticos diariamente é uma das melhores formas de melhorar seu xadrez.</p>
                `;
            },

            tellChessHistory() {
                return `
                    <h3>História do Xadrez</h3>
                    <p>O xadrez tem uma história rica que remonta mais de 1500 anos:</p>
                    
                    <ul>
                        <li><strong>Origens (século VI)</strong>: Surgiu na Índia como "Chaturanga", um jogo que simulava guerra.</li>
                        <li><strong>Pérsia (século VII)</strong>: Transformou-se em "Shatranj" e se espalhou pelo mundo islâmico.</li>
                        <li><strong>Europa (século X)</strong>: Chegou à Europa através da Espanha moura e da Rússia.</li>
                        <li><strong>Regras modernas (século XV)</strong>: Na Espanha e Itália, a rainha e o bispo ganharam movimentos mais poderosos.</li>
                        <li><strong>Primeiros campeonatos (século XIX)</strong>: Wilhelm Steinitz tornou-se o primeiro Campeão Mundial oficial em 1886.</li>
                        <li><strong>Era moderna</strong>: Computadores como Deep Blue (1997) e AlphaZero revolucionaram o xadrez.</li>
                    </ul>
                    
                    <p>Curiosidade: O xadrez é considerado esporte em mais de 100 países e é reconhecido pelo Comitê Olímpico Internacional.</p>
                `;
            }
        };

        // Inicializa o ViBot quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            ViBot.init();
        });
    </script>
</body>
</html>
